BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%bisque%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 269118938.398303
 ALGERIA                   |   1997 | 463359848.827836
 ALGERIA                   |   1996 | 463629395.800785
 ALGERIA                   |   1995 |  463563824.61326
 ALGERIA                   |   1994 | 461944572.102557
 ALGERIA                   |   1993 | 462957490.670211
 ALGERIA                   |   1992 | 454559454.510044
 ARGENTINA                 |   1998 | 271089569.527681
 ARGENTINA                 |   1997 | 466696342.957775
 ARGENTINA                 |   1996 | 468654493.493252
 ARGENTINA                 |   1995 | 460380984.707601
 ARGENTINA                 |   1994 | 464986854.364192
 ARGENTINA                 |   1993 | 462712658.372911
 ARGENTINA                 |   1992 | 462475591.947772
 BRAZIL                    |   1998 | 276684892.131893
 BRAZIL                    |   1997 | 473628282.555652
 BRAZIL                    |   1996 | 477542585.765686
 BRAZIL                    |   1995 | 468296456.822582
 BRAZIL                    |   1994 | 476602856.307545
 BRAZIL                    |   1993 | 468274503.367626
 BRAZIL                    |   1992 | 476395218.063868
 CANADA                    |   1998 | 282604015.970148
 CANADA                    |   1997 | 480870951.527911
 CANADA                    |   1996 | 482623540.302875
 CANADA                    |   1995 | 478833527.243943
 CANADA                    |   1994 | 486326156.378546
 CANADA                    |   1993 | 472052398.795845
 CANADA                    |   1992 | 481275797.435348
 CHINA                     |   1998 | 273420386.066923
 CHINA                     |   1997 | 474511532.868975
 CHINA                     |   1996 | 470851107.997776
 CHINA                     |   1995 | 473332146.309987
 CHINA                     |   1994 | 469335573.318335
 CHINA                     |   1993 | 480092461.766468
 CHINA                     |   1992 | 475320564.536149
 EGYPT                     |   1998 | 279329159.000219
 EGYPT                     |   1997 | 470771509.526561
 EGYPT                     |   1996 | 473905653.252847
 EGYPT                     |   1995 | 468900220.794778
 EGYPT                     |   1994 | 479146474.547312
 EGYPT                     |   1993 | 469952172.284557
 EGYPT                     |   1992 | 473031036.485956
 ETHIOPIA                  |   1998 | 272960505.322532
 ETHIOPIA                  |   1997 | 464104918.242529
 ETHIOPIA                  |   1996 | 464969390.702883
 ETHIOPIA                  |   1995 | 454683370.771048
 ETHIOPIA                  |   1994 | 458636934.147368
 ETHIOPIA                  |   1993 | 460946015.593542
 ETHIOPIA                  |   1992 | 467914296.714388
 FRANCE                    |   1998 |  275405897.74643
 FRANCE                    |   1997 | 456673315.578275
 FRANCE                    |   1996 | 466936823.593882
 FRANCE                    |   1995 | 459129923.006572
 FRANCE                    |   1994 | 461321488.897463
 FRANCE                    |   1993 | 465639780.541824
 FRANCE                    |   1992 | 457838250.073279
 GERMANY                   |   1998 | 271578981.077704
 GERMANY                   |   1997 | 464091374.356479
 GERMANY                   |   1996 | 456822920.927257
 GERMANY                   |   1995 | 471098526.847867
 GERMANY                   |   1994 | 472893196.342367
 GERMANY                   |   1993 | 466489254.293026
 GERMANY                   |   1992 | 471514857.311806
 INDIA                     |   1998 | 275650151.451343
 INDIA                     |   1997 | 478559656.038551
 INDIA                     |   1996 | 476720544.888019
 INDIA                     |   1995 | 474062497.568737
 INDIA                     |   1994 |  480015768.08628
 INDIA                     |   1993 | 469674364.877801
 INDIA                     |   1992 |  474946761.65425
 INDONESIA                 |   1998 | 271562395.781893
 INDONESIA                 |   1997 | 466541195.842614
 INDONESIA                 |   1996 | 469391541.367895
 INDONESIA                 |   1995 | 464767429.387683
 INDONESIA                 |   1994 | 463236583.095101
 INDONESIA                 |   1993 | 466425573.442728
 INDONESIA                 |   1992 | 467176188.808151
 IRAN                      |   1998 | 271812007.759537
 IRAN                      |   1997 | 470485634.841435
 IRAN                      |   1996 | 467401173.371658
 IRAN                      |   1995 | 474631810.687733
 IRAN                      |   1994 | 467273205.930107
 IRAN                      |   1993 | 470577619.214419
 IRAN                      |   1992 | 473112255.075757
 IRAQ                      |   1998 | 278200634.488517
 IRAQ                      |   1997 | 476285683.301176
 IRAQ                      |   1996 | 472721488.701306
 IRAQ                      |   1995 | 473524597.260992
 IRAQ                      |   1994 | 479189928.763846
 IRAQ                      |   1993 | 474452695.161631
 IRAQ                      |   1992 |  483236708.21751
 JAPAN                     |   1998 | 269961105.992057
 JAPAN                     |   1997 | 464082962.712806
 JAPAN                     |   1996 | 473380550.425921
 JAPAN                     |   1995 | 460522182.419657
 JAPAN                     |   1994 | 462257274.151725
 JAPAN                     |   1993 |  467399876.85635
 JAPAN                     |   1992 | 462796552.315972
 JORDAN                    |   1998 |  279373373.11672
 JORDAN                    |   1997 | 465062951.689023
 JORDAN                    |   1996 | 466185081.596732
 JORDAN                    |   1995 | 457271949.614833
 JORDAN                    |   1994 | 464395363.739287
 JORDAN                    |   1993 | 465188185.605459
 JORDAN                    |   1992 | 459642624.083334
 KENYA                     |   1998 | 278341889.343738
 KENYA                     |   1997 | 474244150.540887
 KENYA                     |   1996 | 482050963.629318
 KENYA                     |   1995 |  485171402.32419
 KENYA                     |   1994 | 479697535.776625
 KENYA                     |   1993 | 475707283.081565
 KENYA                     |   1992 | 480049551.304819
 MOROCCO                   |   1998 |  276874432.08291
 MOROCCO                   |   1997 | 465539061.773034
 MOROCCO                   |   1996 | 467918082.670826
 MOROCCO                   |   1995 | 471135891.955839
 MOROCCO                   |   1994 |   467532977.4611
 MOROCCO                   |   1993 | 473323678.127064
 MOROCCO                   |   1992 | 474518042.627029
 MOZAMBIQUE                |   1998 | 269276461.747701
 MOZAMBIQUE                |   1997 | 456988853.162794
 MOZAMBIQUE                |   1996 | 457782529.561457
 MOZAMBIQUE                |   1995 | 460414108.926629
 MOZAMBIQUE                |   1994 | 461628168.097463
 MOZAMBIQUE                |   1993 | 449333361.521338
 MOZAMBIQUE                |   1992 | 452563178.554693
 PERU                      |   1998 |  273743345.06594
 PERU                      |   1997 | 474252544.372292
 PERU                      |   1996 | 479314282.976935
 PERU                      |   1995 | 476958090.207127
 PERU                      |   1994 | 468035466.998341
 PERU                      |   1993 | 469512787.531975
 PERU                      |   1992 | 470845474.051442
 ROMANIA                   |   1998 | 283265007.470951
 ROMANIA                   |   1997 |  480347816.34149
 ROMANIA                   |   1996 | 476384343.496393
 ROMANIA                   |   1995 | 478120767.038989
 ROMANIA                   |   1994 | 473969261.983162
 ROMANIA                   |   1993 | 481287124.452961
 ROMANIA                   |   1992 | 474639252.793931
 RUSSIA                    |   1998 | 279425959.437782
 RUSSIA                    |   1997 | 482047019.367527
 RUSSIA                    |   1996 | 470899209.192701
 RUSSIA                    |   1995 | 473278122.343811
 RUSSIA                    |   1994 |  468907240.35363
 RUSSIA                    |   1993 | 470746896.080113
 RUSSIA                    |   1992 | 475097003.447078
 SAUDI ARABIA              |   1998 |  279083010.75098
 SAUDI ARABIA              |   1997 | 474084682.703947
 SAUDI ARABIA              |   1996 | 474144673.567015
 SAUDI ARABIA              |   1995 | 477325376.127422
 SAUDI ARABIA              |   1994 | 473354428.737588
 SAUDI ARABIA              |   1993 | 474324667.297995
 SAUDI ARABIA              |   1992 | 483149277.567099
 UNITED KINGDOM            |   1998 | 275852355.063096
 UNITED KINGDOM            |   1997 | 466665151.463092
 UNITED KINGDOM            |   1996 | 467333150.370863
 UNITED KINGDOM            |   1995 | 465385976.564616
 UNITED KINGDOM            |   1994 | 472221588.549009
 UNITED KINGDOM            |   1993 | 468612176.111201
 UNITED KINGDOM            |   1992 | 469929859.467977
 UNITED STATES             |   1998 | 271896905.448257
 UNITED STATES             |   1997 | 477665071.937476
 UNITED STATES             |   1996 | 480582162.310197
 UNITED STATES             |   1995 |  482222230.17251
 UNITED STATES             |   1994 | 474665558.278816
 UNITED STATES             |   1993 | 479297661.474306
 UNITED STATES             |   1992 | 477851860.092642
 VIETNAM                   |   1998 | 267430870.689278
 VIETNAM                   |   1997 | 464569950.938412
 VIETNAM                   |   1996 | 473309885.043212
 VIETNAM                   |   1995 | 461869067.642236
 VIETNAM                   |   1994 | 474229370.747969
 VIETNAM                   |   1993 | 468498693.606373
 VIETNAM                   |   1992 | 474157758.295381
(175 rows)

COMMIT;
COMMIT
