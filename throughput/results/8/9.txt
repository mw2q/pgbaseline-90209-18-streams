BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%honeydew%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 272035469.680307
 ALGERIA                   |   1997 | 458609635.455036
 ALGERIA                   |   1996 | 455759687.697468
 ALGERIA                   |   1995 | 463812706.515894
 ALGERIA                   |   1994 | 455923299.256545
 ALGERIA                   |   1993 | 466230073.993813
 ALGERIA                   |   1992 | 456463111.496106
 ARGENTINA                 |   1998 | 281819670.189457
 ARGENTINA                 |   1997 | 476699751.607486
 ARGENTINA                 |   1996 | 473961976.887876
 ARGENTINA                 |   1995 | 478611100.112059
 ARGENTINA                 |   1994 | 479764685.979051
 ARGENTINA                 |   1993 | 477257691.785464
 ARGENTINA                 |   1992 | 479789447.832922
 BRAZIL                    |   1998 | 274697563.037581
 BRAZIL                    |   1997 |  476189927.36831
 BRAZIL                    |   1996 | 472146033.259576
 BRAZIL                    |   1995 | 470660634.701697
 BRAZIL                    |   1994 | 480005032.169204
 BRAZIL                    |   1993 | 466198792.059313
 BRAZIL                    |   1992 | 473922430.580724
 CANADA                    |   1998 | 281212070.808269
 CANADA                    |   1997 | 476718387.098133
 CANADA                    |   1996 | 469707681.857213
 CANADA                    |   1995 | 475385344.543884
 CANADA                    |   1994 | 479984830.564246
 CANADA                    |   1993 | 470254395.863138
 CANADA                    |   1992 | 471251331.001977
 CHINA                     |   1998 | 274222114.275572
 CHINA                     |   1997 |  467555792.29889
 CHINA                     |   1996 | 475179917.222125
 CHINA                     |   1995 | 469948102.673899
 CHINA                     |   1994 | 475505764.695907
 CHINA                     |   1993 | 468029370.527132
 CHINA                     |   1992 | 478292247.026882
 EGYPT                     |   1998 | 271957140.204736
 EGYPT                     |   1997 | 471592593.537306
 EGYPT                     |   1996 | 474185346.063614
 EGYPT                     |   1995 | 459642046.498163
 EGYPT                     |   1994 | 461669707.197911
 EGYPT                     |   1993 | 466675343.222012
 EGYPT                     |   1992 | 464971546.634621
 ETHIOPIA                  |   1998 | 276968310.266225
 ETHIOPIA                  |   1997 | 464884471.771779
 ETHIOPIA                  |   1996 | 464482734.555994
 ETHIOPIA                  |   1995 |  469706758.48924
 ETHIOPIA                  |   1994 | 468111240.025172
 ETHIOPIA                  |   1993 | 467837575.886388
 ETHIOPIA                  |   1992 | 466916055.438623
 FRANCE                    |   1998 | 264511542.194888
 FRANCE                    |   1997 | 454293168.718012
 FRANCE                    |   1996 | 456703334.087123
 FRANCE                    |   1995 | 454214406.838941
 FRANCE                    |   1994 |  451231404.84434
 FRANCE                    |   1993 | 452792960.634556
 FRANCE                    |   1992 |  456735773.78055
 GERMANY                   |   1998 | 282283049.600122
 GERMANY                   |   1997 | 477249662.410066
 GERMANY                   |   1996 | 477987168.837648
 GERMANY                   |   1995 | 485855978.484553
 GERMANY                   |   1994 | 476621293.263285
 GERMANY                   |   1993 | 474809561.680335
 GERMANY                   |   1992 | 480240785.983294
 INDIA                     |   1998 | 276951267.682404
 INDIA                     |   1997 | 472275166.433622
 INDIA                     |   1996 | 475017949.915124
 INDIA                     |   1995 | 476030194.456374
 INDIA                     |   1994 | 472219223.477789
 INDIA                     |   1993 |  468386807.98705
 INDIA                     |   1992 | 473554006.912152
 INDONESIA                 |   1998 | 272438178.516928
 INDONESIA                 |   1997 | 465174192.272565
 INDONESIA                 |   1996 | 465238489.488221
 INDONESIA                 |   1995 | 456345853.660578
 INDONESIA                 |   1994 | 466233333.278671
 INDONESIA                 |   1993 | 462232471.790519
 INDONESIA                 |   1992 | 463229846.951547
 IRAN                      |   1998 | 274533515.711413
 IRAN                      |   1997 | 470965624.337752
 IRAN                      |   1996 | 466011383.551611
 IRAN                      |   1995 | 462735608.728359
 IRAN                      |   1994 | 461170446.548396
 IRAN                      |   1993 | 469306407.368826
 IRAN                      |   1992 | 465744776.711671
 IRAQ                      |   1998 | 274345522.594151
 IRAQ                      |   1997 | 466152247.199901
 IRAQ                      |   1996 | 469879977.527701
 IRAQ                      |   1995 | 468302676.975727
 IRAQ                      |   1994 | 463705182.781743
 IRAQ                      |   1993 | 470957736.414177
 IRAQ                      |   1992 | 469797746.628332
 JAPAN                     |   1998 | 272255089.651859
 JAPAN                     |   1997 | 472463265.082444
 JAPAN                     |   1996 | 456097479.922417
 JAPAN                     |   1995 | 464052784.425846
 JAPAN                     |   1994 | 470879181.167585
 JAPAN                     |   1993 | 464178298.061027
 JAPAN                     |   1992 | 466299111.468229
 JORDAN                    |   1998 | 272535891.018678
 JORDAN                    |   1997 | 460970193.006802
 JORDAN                    |   1996 | 458181287.696139
 JORDAN                    |   1995 | 466631954.928904
 JORDAN                    |   1994 | 464076946.782571
 JORDAN                    |   1993 | 473864321.352511
 JORDAN                    |   1992 | 457113181.420622
 KENYA                     |   1998 |  276521129.45917
 KENYA                     |   1997 | 470740780.308759
 KENYA                     |   1996 | 470092203.576124
 KENYA                     |   1995 | 467179882.912626
 KENYA                     |   1994 | 469409236.202344
 KENYA                     |   1993 | 468916130.219971
 KENYA                     |   1992 |  470267503.42037
 MOROCCO                   |   1998 | 274312965.723272
 MOROCCO                   |   1997 | 469004096.010036
 MOROCCO                   |   1996 | 471635972.331977
 MOROCCO                   |   1995 | 473638032.601423
 MOROCCO                   |   1994 | 472920008.046258
 MOROCCO                   |   1993 | 473617993.444601
 MOROCCO                   |   1992 | 473076051.182861
 MOZAMBIQUE                |   1998 | 270118944.562624
 MOZAMBIQUE                |   1997 | 456975272.889262
 MOZAMBIQUE                |   1996 | 467354958.585835
 MOZAMBIQUE                |   1995 | 466297737.149909
 MOZAMBIQUE                |   1994 | 464190758.551906
 MOZAMBIQUE                |   1993 | 452400485.790032
 MOZAMBIQUE                |   1992 | 458287394.361931
 PERU                      |   1998 | 266173453.254902
 PERU                      |   1997 | 461057910.200715
 PERU                      |   1996 | 458398945.638345
 PERU                      |   1995 | 460713195.008582
 PERU                      |   1994 | 450918511.973421
 PERU                      |   1993 | 453864045.383935
 PERU                      |   1992 | 460983271.167499
 ROMANIA                   |   1998 | 282304837.230861
 ROMANIA                   |   1997 | 473504240.476727
 ROMANIA                   |   1996 | 475411131.575697
 ROMANIA                   |   1995 | 476181532.511552
 ROMANIA                   |   1994 | 475265528.129353
 ROMANIA                   |   1993 | 475573223.804351
 ROMANIA                   |   1992 | 472001329.960003
 RUSSIA                    |   1998 | 283760370.669826
 RUSSIA                    |   1997 | 479918316.242051
 RUSSIA                    |   1996 | 475219623.470203
 RUSSIA                    |   1995 | 480562484.268216
 RUSSIA                    |   1994 | 480377357.475456
 RUSSIA                    |   1993 | 477522805.052089
 RUSSIA                    |   1992 | 479462427.324939
 SAUDI ARABIA              |   1998 | 272718291.568511
 SAUDI ARABIA              |   1997 | 458873483.145849
 SAUDI ARABIA              |   1996 |  469585991.28607
 SAUDI ARABIA              |   1995 | 468762586.989851
 SAUDI ARABIA              |   1994 | 461540627.538282
 SAUDI ARABIA              |   1993 | 460190930.300508
 SAUDI ARABIA              |   1992 | 460153964.202148
 UNITED KINGDOM            |   1998 | 271317137.927796
 UNITED KINGDOM            |   1997 | 466362762.420053
 UNITED KINGDOM            |   1996 | 461150110.420573
 UNITED KINGDOM            |   1995 | 463813380.066107
 UNITED KINGDOM            |   1994 | 468000861.814099
 UNITED KINGDOM            |   1993 | 469641759.940917
 UNITED KINGDOM            |   1992 | 469481233.682705
 UNITED STATES             |   1998 | 277549614.025685
 UNITED STATES             |   1997 | 474393221.002192
 UNITED STATES             |   1996 | 472919043.330944
 UNITED STATES             |   1995 | 472117063.389893
 UNITED STATES             |   1994 | 481051954.601202
 UNITED STATES             |   1993 | 480728459.024892
 UNITED STATES             |   1992 | 476045268.147389
 VIETNAM                   |   1998 | 274655881.199354
 VIETNAM                   |   1997 | 468189287.870669
 VIETNAM                   |   1996 | 470579109.033717
 VIETNAM                   |   1995 | 466500850.313903
 VIETNAM                   |   1994 | 464983292.358804
 VIETNAM                   |   1993 | 466292166.161816
 VIETNAM                   |   1992 | 461750150.529236
(175 rows)

COMMIT;
COMMIT
