BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%cornflower%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 |  264403269.77371
 ALGERIA                   |   1997 | 456564708.844089
 ALGERIA                   |   1996 | 463096711.034427
 ALGERIA                   |   1995 |  465546134.76465
 ALGERIA                   |   1994 | 452745581.129477
 ALGERIA                   |   1993 |  455929817.81652
 ALGERIA                   |   1992 | 466617265.361121
 ARGENTINA                 |   1998 |  275532833.64898
 ARGENTINA                 |   1997 | 462445999.836464
 ARGENTINA                 |   1996 | 465411344.666882
 ARGENTINA                 |   1995 | 470779168.391981
 ARGENTINA                 |   1994 | 467533809.978556
 ARGENTINA                 |   1993 | 461071474.591787
 ARGENTINA                 |   1992 | 459825272.109286
 BRAZIL                    |   1998 | 280549223.122172
 BRAZIL                    |   1997 | 473862769.281816
 BRAZIL                    |   1996 | 467689113.696039
 BRAZIL                    |   1995 | 466765115.973571
 BRAZIL                    |   1994 | 471655296.032187
 BRAZIL                    |   1993 | 466918639.716306
 BRAZIL                    |   1992 | 469350019.144869
 CANADA                    |   1998 | 280734861.289141
 CANADA                    |   1997 |  475349345.23691
 CANADA                    |   1996 | 477545255.921933
 CANADA                    |   1995 | 473150388.232406
 CANADA                    |   1994 | 490439484.514373
 CANADA                    |   1993 | 484563103.860574
 CANADA                    |   1992 | 481233500.588186
 CHINA                     |   1998 | 274354790.562942
 CHINA                     |   1997 | 469275677.893163
 CHINA                     |   1996 |  473128671.94516
 CHINA                     |   1995 | 469594641.230212
 CHINA                     |   1994 | 462188693.204396
 CHINA                     |   1993 | 464587946.796984
 CHINA                     |   1992 | 467178808.819568
 EGYPT                     |   1998 | 275446408.754677
 EGYPT                     |   1997 | 465935843.933059
 EGYPT                     |   1996 | 476482847.858537
 EGYPT                     |   1995 | 468525546.301828
 EGYPT                     |   1994 | 467418620.949744
 EGYPT                     |   1993 | 472443433.133791
 EGYPT                     |   1992 | 464946899.282468
 ETHIOPIA                  |   1998 | 265897267.804659
 ETHIOPIA                  |   1997 | 453484884.857778
 ETHIOPIA                  |   1996 | 454804359.704652
 ETHIOPIA                  |   1995 | 458678892.817858
 ETHIOPIA                  |   1994 | 456812383.532289
 ETHIOPIA                  |   1993 | 455593726.899753
 ETHIOPIA                  |   1992 | 461714600.840791
 FRANCE                    |   1998 |  271811380.17327
 FRANCE                    |   1997 | 455952430.457772
 FRANCE                    |   1996 | 470427899.486746
 FRANCE                    |   1995 |  456072726.87714
 FRANCE                    |   1994 | 461925858.895629
 FRANCE                    |   1993 |  467350777.80428
 FRANCE                    |   1992 | 462230819.873317
 GERMANY                   |   1998 | 284502687.208339
 GERMANY                   |   1997 | 485156661.455764
 GERMANY                   |   1996 | 486143415.533204
 GERMANY                   |   1995 | 488482922.545628
 GERMANY                   |   1994 | 492159202.021913
 GERMANY                   |   1993 | 482865387.850599
 GERMANY                   |   1992 | 484482942.962158
 INDIA                     |   1998 |  274731662.02529
 INDIA                     |   1997 | 475819169.178191
 INDIA                     |   1996 | 473964103.122455
 INDIA                     |   1995 | 470296242.091889
 INDIA                     |   1994 |  473124919.27667
 INDIA                     |   1993 | 464101028.542232
 INDIA                     |   1992 | 474531425.543225
 INDONESIA                 |   1998 | 269412961.983955
 INDONESIA                 |   1997 | 460501069.971992
 INDONESIA                 |   1996 | 466490787.331303
 INDONESIA                 |   1995 | 461070648.499862
 INDONESIA                 |   1994 | 457238716.306556
 INDONESIA                 |   1993 | 463487844.830676
 INDONESIA                 |   1992 | 457830024.049242
 IRAN                      |   1998 | 279332251.666032
 IRAN                      |   1997 | 467584750.374114
 IRAN                      |   1996 | 468876211.555128
 IRAN                      |   1995 | 474403516.553914
 IRAN                      |   1994 | 473272647.847274
 IRAN                      |   1993 | 464071062.341486
 IRAN                      |   1992 | 471949172.684826
 IRAQ                      |   1998 | 277032217.689482
 IRAQ                      |   1997 | 464256223.610494
 IRAQ                      |   1996 | 471992069.359772
 IRAQ                      |   1995 | 463899739.917485
 IRAQ                      |   1994 | 466683083.106855
 IRAQ                      |   1993 | 467257140.554898
 IRAQ                      |   1992 | 467184201.336819
 JAPAN                     |   1998 | 274176831.414877
 JAPAN                     |   1997 | 472733052.377389
 JAPAN                     |   1996 | 462824400.662875
 JAPAN                     |   1995 |  460626099.43396
 JAPAN                     |   1994 | 469081900.629034
 JAPAN                     |   1993 | 468179264.294563
 JAPAN                     |   1992 | 472676707.942782
 JORDAN                    |   1998 | 273193474.898996
 JORDAN                    |   1997 | 470041272.392105
 JORDAN                    |   1996 | 469015068.421081
 JORDAN                    |   1995 | 465966262.693642
 JORDAN                    |   1994 |  469283987.33028
 JORDAN                    |   1993 | 469372978.889936
 JORDAN                    |   1992 |  467375217.84153
 KENYA                     |   1998 | 278508009.591586
 KENYA                     |   1997 | 471028007.334678
 KENYA                     |   1996 | 473819214.131305
 KENYA                     |   1995 | 467939743.874574
 KENYA                     |   1994 | 473981736.645206
 KENYA                     |   1993 | 458844108.370248
 KENYA                     |   1992 | 466705374.619458
 MOROCCO                   |   1998 | 280103125.144753
 MOROCCO                   |   1997 | 474172775.632693
 MOROCCO                   |   1996 | 470674793.622152
 MOROCCO                   |   1995 | 468875650.329921
 MOROCCO                   |   1994 | 469202810.400908
 MOROCCO                   |   1993 | 462924131.974756
 MOROCCO                   |   1992 | 471323668.939476
 MOZAMBIQUE                |   1998 | 273236348.937588
 MOZAMBIQUE                |   1997 |  466270991.85345
 MOZAMBIQUE                |   1996 | 466471741.036021
 MOZAMBIQUE                |   1995 |  469906322.08377
 MOZAMBIQUE                |   1994 | 458627793.642562
 MOZAMBIQUE                |   1993 | 467281782.045937
 MOZAMBIQUE                |   1992 | 460362502.273858
 PERU                      |   1998 | 265986140.491609
 PERU                      |   1997 | 457788085.694851
 PERU                      |   1996 | 457388629.120709
 PERU                      |   1995 | 455179234.924099
 PERU                      |   1994 | 463360550.818433
 PERU                      |   1993 | 465275620.090546
 PERU                      |   1992 | 458143002.781636
 ROMANIA                   |   1998 | 272969249.299084
 ROMANIA                   |   1997 | 465088726.037318
 ROMANIA                   |   1996 |   474918246.4016
 ROMANIA                   |   1995 | 467732633.579411
 ROMANIA                   |   1994 | 466933493.719758
 ROMANIA                   |   1993 |  467499962.11666
 ROMANIA                   |   1992 | 465424334.942244
 RUSSIA                    |   1998 | 272632355.950261
 RUSSIA                    |   1997 | 469559544.926546
 RUSSIA                    |   1996 | 467335753.700796
 RUSSIA                    |   1995 | 470690896.594038
 RUSSIA                    |   1994 | 468798266.292658
 RUSSIA                    |   1993 | 471394518.075649
 RUSSIA                    |   1992 | 465921572.441169
 SAUDI ARABIA              |   1998 | 275235240.718721
 SAUDI ARABIA              |   1997 | 468297093.323552
 SAUDI ARABIA              |   1996 |  466188257.89891
 SAUDI ARABIA              |   1995 | 472462091.450244
 SAUDI ARABIA              |   1994 | 465625520.192319
 SAUDI ARABIA              |   1993 |  474655659.21532
 SAUDI ARABIA              |   1992 | 467884266.773561
 UNITED KINGDOM            |   1998 | 269809142.641978
 UNITED KINGDOM            |   1997 | 453592663.996812
 UNITED KINGDOM            |   1996 | 462123465.665467
 UNITED KINGDOM            |   1995 |  454223319.24054
 UNITED KINGDOM            |   1994 | 450779889.215186
 UNITED KINGDOM            |   1993 | 451982042.921448
 UNITED KINGDOM            |   1992 |  463906525.46885
 UNITED STATES             |   1998 | 275942695.189934
 UNITED STATES             |   1997 |  481289982.32039
 UNITED STATES             |   1996 |  469915089.18176
 UNITED STATES             |   1995 | 473969609.631104
 UNITED STATES             |   1994 | 476044745.189378
 UNITED STATES             |   1993 |  484592845.84563
 UNITED STATES             |   1992 | 474074816.858123
 VIETNAM                   |   1998 | 269665840.573123
 VIETNAM                   |   1997 |   463235718.0878
 VIETNAM                   |   1996 | 469080142.511288
 VIETNAM                   |   1995 | 472249127.258561
 VIETNAM                   |   1994 | 466250752.627088
 VIETNAM                   |   1993 | 465389434.382619
 VIETNAM                   |   1992 | 465841923.032683
(175 rows)

COMMIT;
COMMIT
