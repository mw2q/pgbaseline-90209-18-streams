BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%saddle%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264716055.530608
 ALGERIA                   |   1997 | 458250176.199168
 ALGERIA                   |   1996 | 464890050.977348
 ALGERIA                   |   1995 |  464794991.12997
 ALGERIA                   |   1994 | 466649330.914608
 ALGERIA                   |   1993 | 463545707.704741
 ALGERIA                   |   1992 | 462853130.997142
 ARGENTINA                 |   1998 | 278611298.751349
 ARGENTINA                 |   1997 | 469297944.862165
 ARGENTINA                 |   1996 |  467369196.22636
 ARGENTINA                 |   1995 | 468004965.677203
 ARGENTINA                 |   1994 | 471429829.931948
 ARGENTINA                 |   1993 | 468506164.815918
 ARGENTINA                 |   1992 | 462618462.866476
 BRAZIL                    |   1998 | 277024827.084991
 BRAZIL                    |   1997 | 472401125.889904
 BRAZIL                    |   1996 | 471799497.118722
 BRAZIL                    |   1995 | 467243044.228381
 BRAZIL                    |   1994 | 465795734.132649
 BRAZIL                    |   1993 | 469422908.924984
 BRAZIL                    |   1992 | 469071334.823421
 CANADA                    |   1998 | 272365082.805987
 CANADA                    |   1997 | 474174382.378152
 CANADA                    |   1996 | 475230783.636944
 CANADA                    |   1995 | 480954546.445946
 CANADA                    |   1994 | 475230484.930231
 CANADA                    |   1993 | 485406165.039519
 CANADA                    |   1992 | 479379436.182306
 CHINA                     |   1998 | 274064648.088568
 CHINA                     |   1997 | 466210926.241159
 CHINA                     |   1996 |  462105240.27651
 CHINA                     |   1995 | 468385716.867676
 CHINA                     |   1994 | 464866987.617113
 CHINA                     |   1993 | 464441347.661256
 CHINA                     |   1992 | 467729433.599402
 EGYPT                     |   1998 | 268601084.252934
 EGYPT                     |   1997 | 456004674.031474
 EGYPT                     |   1996 | 458509106.997652
 EGYPT                     |   1995 | 458058584.331053
 EGYPT                     |   1994 | 453672302.302527
 EGYPT                     |   1993 | 466647391.604492
 EGYPT                     |   1992 | 447231369.819354
 ETHIOPIA                  |   1998 | 271327303.589553
 ETHIOPIA                  |   1997 | 466164787.071847
 ETHIOPIA                  |   1996 | 462927351.785103
 ETHIOPIA                  |   1995 | 457938344.428785
 ETHIOPIA                  |   1994 | 464905988.780875
 ETHIOPIA                  |   1993 | 462668959.523055
 ETHIOPIA                  |   1992 | 469284749.052782
 FRANCE                    |   1998 | 267321045.420729
 FRANCE                    |   1997 |  456475010.86211
 FRANCE                    |   1996 | 455097867.849945
 FRANCE                    |   1995 | 461442317.874494
 FRANCE                    |   1994 | 468588771.018295
 FRANCE                    |   1993 | 460036685.099075
 FRANCE                    |   1992 |  461619979.85915
 GERMANY                   |   1998 |  277165099.61395
 GERMANY                   |   1997 | 481127333.168507
 GERMANY                   |   1996 | 480928993.256485
 GERMANY                   |   1995 | 479483304.775744
 GERMANY                   |   1994 | 479150787.460943
 GERMANY                   |   1993 | 483585405.239053
 GERMANY                   |   1992 |  480000732.73474
 INDIA                     |   1998 | 276132742.608092
 INDIA                     |   1997 | 475920479.016547
 INDIA                     |   1996 | 474448524.957462
 INDIA                     |   1995 |  481049502.37129
 INDIA                     |   1994 | 486744339.387414
 INDIA                     |   1993 | 473406285.962149
 INDIA                     |   1992 | 477129342.701895
 INDONESIA                 |   1998 | 269672691.638875
 INDONESIA                 |   1997 | 466000085.329972
 INDONESIA                 |   1996 | 470692154.294279
 INDONESIA                 |   1995 | 466047026.962881
 INDONESIA                 |   1994 | 473620359.138961
 INDONESIA                 |   1993 | 466858632.684724
 INDONESIA                 |   1992 | 468870380.149024
 IRAN                      |   1998 | 263734668.223558
 IRAN                      |   1997 | 456076162.950266
 IRAN                      |   1996 | 458513297.923778
 IRAN                      |   1995 | 458858437.653389
 IRAN                      |   1994 | 451690958.118155
 IRAN                      |   1993 | 453615537.266661
 IRAN                      |   1992 | 460073724.449891
 IRAQ                      |   1998 | 280667766.612001
 IRAQ                      |   1997 | 467619879.802195
 IRAQ                      |   1996 | 471282083.948862
 IRAQ                      |   1995 | 466862288.793457
 IRAQ                      |   1994 | 477285105.538568
 IRAQ                      |   1993 | 471928681.333086
 IRAQ                      |   1992 | 477407650.216381
 JAPAN                     |   1998 | 265156380.875801
 JAPAN                     |   1997 | 465237983.434607
 JAPAN                     |   1996 | 463800955.611983
 JAPAN                     |   1995 | 459858908.768048
 JAPAN                     |   1994 | 462139444.169958
 JAPAN                     |   1993 | 464555969.186334
 JAPAN                     |   1992 | 466458344.591681
 JORDAN                    |   1998 | 273056786.575368
 JORDAN                    |   1997 | 460251207.235148
 JORDAN                    |   1996 | 466303587.903953
 JORDAN                    |   1995 | 460841274.107148
 JORDAN                    |   1994 | 466371672.545762
 JORDAN                    |   1993 | 461320858.820796
 JORDAN                    |   1992 |   460045264.4619
 KENYA                     |   1998 |   268193236.5312
 KENYA                     |   1997 | 463188726.584208
 KENYA                     |   1996 | 468747318.375255
 KENYA                     |   1995 | 470066670.734444
 KENYA                     |   1994 | 462243087.447074
 KENYA                     |   1993 | 468902738.117996
 KENYA                     |   1992 | 473671911.575731
 MOROCCO                   |   1998 | 271922967.336326
 MOROCCO                   |   1997 | 471789556.247316
 MOROCCO                   |   1996 | 466000693.890044
 MOROCCO                   |   1995 | 470800664.825315
 MOROCCO                   |   1994 | 465754181.970658
 MOROCCO                   |   1993 | 470848560.254952
 MOROCCO                   |   1992 | 477440654.171229
 MOZAMBIQUE                |   1998 | 272413603.918512
 MOZAMBIQUE                |   1997 |  462731641.78408
 MOZAMBIQUE                |   1996 | 467458348.099431
 MOZAMBIQUE                |   1995 | 459091632.985086
 MOZAMBIQUE                |   1994 | 464687544.686737
 MOZAMBIQUE                |   1993 | 457612090.429836
 MOZAMBIQUE                |   1992 | 454670087.009611
 PERU                      |   1998 | 277993239.971501
 PERU                      |   1997 |  469700383.15793
 PERU                      |   1996 | 468910881.276749
 PERU                      |   1995 |  467628703.05889
 PERU                      |   1994 | 462840256.546791
 PERU                      |   1993 |   467090854.8637
 PERU                      |   1992 | 464412941.067934
 ROMANIA                   |   1998 |  272784355.26053
 ROMANIA                   |   1997 | 463361149.425903
 ROMANIA                   |   1996 | 471663659.008933
 ROMANIA                   |   1995 | 465988127.268958
 ROMANIA                   |   1994 | 462220354.824004
 ROMANIA                   |   1993 | 457619575.764312
 ROMANIA                   |   1992 | 467409335.711922
 RUSSIA                    |   1998 |  277987984.70777
 RUSSIA                    |   1997 | 474885318.322797
 RUSSIA                    |   1996 | 482184629.486082
 RUSSIA                    |   1995 | 467300397.203369
 RUSSIA                    |   1994 | 476075573.439743
 RUSSIA                    |   1993 | 474194543.536023
 RUSSIA                    |   1992 | 467788314.010839
 SAUDI ARABIA              |   1998 | 278669154.208809
 SAUDI ARABIA              |   1997 | 472943097.181449
 SAUDI ARABIA              |   1996 | 481769962.689717
 SAUDI ARABIA              |   1995 | 474220648.249518
 SAUDI ARABIA              |   1994 | 473381460.078377
 SAUDI ARABIA              |   1993 | 473819419.977133
 SAUDI ARABIA              |   1992 | 473889137.904664
 UNITED KINGDOM            |   1998 |  270676605.95493
 UNITED KINGDOM            |   1997 | 461727705.782829
 UNITED KINGDOM            |   1996 | 470757746.428735
 UNITED KINGDOM            |   1995 | 471951424.411317
 UNITED KINGDOM            |   1994 | 470927932.283661
 UNITED KINGDOM            |   1993 | 471422874.382003
 UNITED KINGDOM            |   1992 | 468655511.881084
 UNITED STATES             |   1998 | 276931715.856724
 UNITED STATES             |   1997 | 473009726.393071
 UNITED STATES             |   1996 | 477420842.892796
 UNITED STATES             |   1995 |  476509985.92899
 UNITED STATES             |   1994 | 484635634.515353
 UNITED STATES             |   1993 | 473893439.179445
 UNITED STATES             |   1992 | 473926342.094549
 VIETNAM                   |   1998 | 276643577.017239
 VIETNAM                   |   1997 | 468620026.296335
 VIETNAM                   |   1996 | 469634206.402397
 VIETNAM                   |   1995 |  468257652.71373
 VIETNAM                   |   1994 | 464565426.129735
 VIETNAM                   |   1993 | 472716304.501586
 VIETNAM                   |   1992 | 470380793.465279
(175 rows)

COMMIT;
COMMIT
